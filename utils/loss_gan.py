import torch# cuda ---------------------------------------------------------device = torch.device('cuda:0' if torch.cuda.is_available() else 'cpu')# loss ---------------------------------------------------------def loss_G(output_f, batch_size):    # out_thresh = torch.tensor(1e-9, device=device)    # fake_loss = torch.log(torch.max(output_f, out_thresh))    fake_loss = torch.log(output_f)    loss = torch.sum(fake_loss)    loss = - loss / batch_size    return lossdef loss_D(output_r, output_f, batch_size):    # out_thresh = torch.tensor(1e-9, device=device)    # real_loss = torch.log(torch.max(output_r, out_thresh))    # fake_loss = torch.log(torch.max((1 - output_f), out_thresh))    real_loss = torch.log(output_r)    fake_loss = torch.log(1 - output_f)    loss = torch.sum(real_loss + fake_loss)    loss = - loss / batch_size    return loss